spring.application.name=auth-service

# === Keycloak / OIDC generic settings (externalised, no hard-coded secrets) ===
# IMPORTANT: issuer-uri must include the realm path, e.g. http://localhost:8080/realms/{realm}
app.security.issuer-uri=${KEYCLOAK_ISSUER_URI:http://127.0.0.1:8080/realms/microservice}
app.security.jwk-set-uri=${KEYCLOAK_JWK_SET_URI:${app.security.issuer-uri}/protocol/openid-connect/certs}
app.security.client-id=${KEYCLOAK_CLIENT_ID:auth-service}
# Do NOT hardcode secrets in repository. Provide via environment variable KEYCLOAK_CLIENT_SECRET.
app.security.client-secret=${KEYCLOAK_CLIENT_SECRET:}
app.security.realm=${KEYCLOAK_REALM:microservice}

# Audience / resource identifier used by microservices
app.security.resource-id=${KEYCLOAK_RESOURCE_ID:auth-api}

# Optional: required scopes for SSO and MFA flags (Keycloak config handles real MFA)
app.security.scope.sso=${AUTH_SCOPE_SSO:openid}
app.security.scope.mfa=${AUTH_SCOPE_MFA:mfa}

# Server port (can be overridden)
server.port=${SERVER_PORT:8082}

# Spring Security resource server
spring.security.oauth2.resourceserver.jwt.issuer-uri=${app.security.issuer-uri}
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=${app.security.jwk-set-uri}

# Spring Security client registration for Swagger UI login (authorization_code)
spring.security.oauth2.client.registration.keycloak.client-id=${app.security.client-id}
spring.security.oauth2.client.registration.keycloak.client-secret=${app.security.client-secret}
spring.security.oauth2.client.registration.keycloak.scope=${app.security.scope.sso}
spring.security.oauth2.client.registration.keycloak.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.keycloak.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}

# Provider must point to the full issuer (including realm). Use app.security.issuer-uri to keep a single source of truth.
spring.security.oauth2.client.provider.keycloak.issuer-uri=${app.security.issuer-uri}

# Springdoc OpenAPI
springdoc.api-docs.enabled=true
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.oauth2-redirect-url=/swagger-ui/oauth2-redirect.html
springdoc.swagger-ui.oauth.client-id=${app.security.client-id}

management.endpoints.web.exposure.include=health,info

# Admin client for user management (used by /logup endpoint)
app.security.admin-client-id=${KEYCLOAK_ADMIN_CLIENT_ID:auth-service}
app.security.admin-client-secret=${KEYCLOAK_ADMIN_CLIENT_SECRET:FHylSHdPaejqkxirYWvb4zdeXMgpFSts}
